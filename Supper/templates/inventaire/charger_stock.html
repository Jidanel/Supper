{% extends "admin/base_site.html" %}
{% load static i18n %}
{%load inventaire_extras%}

{% block title %}Charger stock - {{ poste.nom }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <h2><i class="fas fa-plus-circle"></i> Charger le stock - {{ poste.nom }}</h2>
    
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5>Stock actuel</h5>
                </div>
                <div class="card-body">
                    <h3>{{ stock.valeur_monetaire|floatformat:0 }} FCFA</h3>
                    <p>{{ stock.nombre_tickets }} tickets disponibles</p>
                </div>
            </div>
        </div>
    </div>
    
    <form method="post" class="mt-4">
        {% csrf_token %}
        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <label>Montant à ajouter (FCFA)</label>
                    <input type="number" name="montant" class="form-control" required min="500" step="500">
                </div>
                <div class="form-group">
                    <label>Commentaire</label>
                    <textarea name="commentaire" class="form-control" rows="3"></textarea>
                </div>
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-check"></i> Charger le stock
                </button>
                <a href="{% url 'inventaire:liste_postes_stocks' %}" class="btn btn-secondary">
                    Annuler
                </a>
            </div>
        </div>
    </form>
    
    {% if historique_recent %}
    <h4 class="mt-4">Historique récent</h4>
    <table class="table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Montant</th>
                <th>Commentaire</th>
            </tr>
        </thead>
        <tbody>
            {% for h in historique_recent %}
            <tr>
                <td>{{ h.date_mouvement|date:"d/m/Y H:i" }}</td>
                <td>{{ h.montant|floatformat:0|format_milliers  }} FCFA</td>
                <td>{{ h.commentaire }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
</div>
{% endblock %}