{% extends 'admin/base_site.html' %}
{% load static %}

{% block title %}Paramétrage Global{% endblock %}

{% block extra_css %}
<style>
    .preview-header {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        padding: 20px;
        border-radius: 8px;
    }
    .info-box {
        background: #e3f2fd;
        border-left: 4px solid #2196F3;
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 4px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    
    <div class="row mb-4">
        <div class="col-12">
            <h2><i class="fas fa-cog me-2"></i>Paramétrage Global des Documents</h2>
            <p class="text-muted">Configuration des en-têtes bilingues pour tous les postes</p>
        </div>
    </div>
    
    <!-- Information importante -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="info-box">
                <i class="fas fa-info-circle me-2"></i>
                <strong>Information :</strong> Cette configuration s'applique à tous les postes. 
                Seul le nom du poste changera automatiquement lors de la génération des documents.
            </div>
        </div>
    </div>
    
    <!-- Formulaire de configuration -->
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div class="row">
            
            <!-- Colonne Français -->
            <div class="col-lg-6 mb-4">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="fas fa-flag me-2"></i>Français</h5>
                    </div>
                    <div class="card-body">
                        
                        <div class="mb-3">
                            <label class="form-label">République *</label>
                            <input type="text" name="republique_fr" class="form-control" 
                                   value="{{ config.republique_fr }}" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Devise *</label>
                            <input type="text" name="devise_fr" class="form-control" 
                                   value="{{ config.devise_fr }}" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Ministère *</label>
                            <input type="text" name="ministere_fr" class="form-control" 
                                   value="{{ config.ministere_fr }}" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Direction *</label>
                            <input type="text" name="direction_fr" class="form-control" 
                                   value="{{ config.direction_fr }}" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Programme/Service *</label>
                            <input type="text" name="programme_fr" class="form-control" 
                                   value="{{ config.programme_fr }}" required>
                            <small class="text-muted">
                                Ex: PROGRAMME DE SÉCURISATION DES RECETTES ROUTIÈRES
                            </small>
                        </div>
                        
                    </div>
                </div>
            </div>
            
            <!-- Colonne Anglais -->
            <div class="col-lg-6 mb-4">
                <div class="card shadow">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0"><i class="fas fa-flag me-2"></i>English</h5>
                    </div>
                    <div class="card-body">
                        
                        <div class="mb-3">
                            <label class="form-label">Republic *</label>
                            <input type="text" name="republique_en" class="form-control" 
                                   value="{{ config.republique_en }}" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Motto *</label>
                            <input type="text" name="devise_en" class="form-control" 
                                   value="{{ config.devise_en }}" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Ministry *</label>
                            <input type="text" name="ministere_en" class="form-control" 
                                   value="{{ config.ministere_en }}" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Directorate *</label>
                            <input type="text" name="direction_en" class="form-control" 
                                   value="{{ config.direction_en }}" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Program/Service *</label>
                            <input type="text" name="programme_en" class="form-control" 
                                   value="{{ config.programme_en }}" required>
                            <small class="text-muted">
                                Ex: REGIONAL TAXATION CENTER
                            </small>
                        </div>
                        
                    </div>
                </div>
            </div>
            
        </div>
        
        <!-- Logo Global -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card shadow">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0"><i class="fas fa-image me-2"></i>Logo (Tous les postes)</h5>
                    </div>
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-6">
                                <label class="form-label">Télécharger le logo</label>
                                <input type="file" name="logo" class="form-control" accept="image/*">
                                <small class="text-muted d-block mt-2">
                                    <i class="fas fa-lightbulb me-1"></i>
                                    Format recommandé : PNG transparent, 300x300px (max 2MB)
                                </small>
                            </div>
                            <div class="col-md-6 text-center">
                                {% if config.logo %}
                                <img src="{{ config.logo.url }}" alt="Logo actuel" 
                                     style="max-width: 150px; max-height: 150px;" 
                                     class="border rounded shadow-sm">
                                <p class="mt-2 mb-0 text-muted">
                                    <i class="fas fa-check-circle text-success me-1"></i>
                                    Logo actuel
                                </p>
                                {% else %}
                                <div class="border rounded p-4 d-inline-block bg-light">
                                    <i class="fas fa-image fa-3x text-muted"></i>
                                    <p class="mt-2 mb-0 text-muted small">Aucun logo configuré</p>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Aperçu -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card shadow">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0"><i class="fas fa-eye me-2"></i>Aperçu de l'en-tête</h5>
                    </div>
                    <div class="card-body preview-header">
                        <div class="row text-center small">
                            <div class="col-4 text-start">
                                <p class="mb-1"><strong>{{ config.republique_fr }}</strong></p>
                                <p class="mb-1">{{ config.devise_fr }}</p>
                                <p class="mb-1">*****</p>
                                <p class="mb-1"><strong>{{ config.ministere_fr }}</strong></p>
                                <p class="mb-1">*****</p>
                                <p class="mb-1"><strong>{{ config.direction_fr }}</strong></p>
                                <p class="mb-1">**********</p>
                                <p class="mb-1"><strong>{{ config.programme_fr }}</strong></p>
                                <p class="mb-1">*********</p>
                                <p class="mb-1 text-primary"><strong>POSTE DE [NOM DU POSTE]</strong></p>
                            </div>
                            <div class="col-4">
                                {% if config.logo %}
                                <img src="{{ config.logo.url }}" alt="Logo" style="max-width: 100px;">
                                {% else %}
                                <div class="border rounded p-3 d-inline-block" style="width: 100px; height: 100px;">
                                    <p class="text-muted small mb-0 mt-3">DGI</p>
                                </div>
                                {% endif %}
                            </div>
                            <div class="col-4 text-end">
                                <p class="mb-1"><strong>{{ config.republique_en }}</strong></p>
                                <p class="mb-1">{{ config.devise_en }}</p>
                                <p class="mb-1">*****</p>
                                <p class="mb-1"><strong>{{ config.ministere_en }}</strong></p>
                                <p class="mb-1">*****</p>
                                <p class="mb-1"><strong>{{ config.direction_en }}</strong></p>
                                <p class="mb-1">**********</p>
                                <p class="mb-1"><strong>{{ config.programme_en }}</strong></p>
                                <p class="mb-1">*********</p>
                                <p class="mb-1 text-primary"><strong>POST OF [POST NAME]</strong></p>
                            </div>
                        </div>
                        <p class="text-center text-muted small mt-3 mb-0">
                            <i class="fas fa-info-circle me-1"></i>
                            Le nom du poste sera automatiquement inséré lors de la génération des documents
                        </p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Boutons -->
        <div class="row">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center">
                    <a href="{% url 'admin:index' %}" class="btn btn-outline-secondary btn-lg">
                        <i class="fas fa-arrow-left me-2"></i>Retour
                    </a>
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-save me-2"></i>Enregistrer la Configuration Globale
                    </button>
                </div>
            </div>
        </div>
        
    </form>
    
</div>
{% endblock %}